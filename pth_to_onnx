import torch
import torch.nn as nn
from torchvision import models

# ----- load your model -----
model = models.mobilenet_v2(weights=None)
model.classifier = nn.Sequential(
    nn.Dropout(0.3),
    nn.Linear(model.last_channel, 3)
)
model.load_state_dict(torch.load("jimjam_classifier.pth", map_location="cpu"))
model.eval()

dummy_input = torch.randn(1, 3, 224, 224)

torch.onnx.export(
    model,
    dummy_input,
    "jimjam_classifier.onnx",
    input_names=["input"],
    output_names=["output"],
    opset_version=12
)

print("Saved ONNX model!")
